---
import fetchApi from '../../lib/strapi';
import type Article from '../../interfaces/article';

const articles = await fetchApi<Article[]>({
    endpoint: 'articles?populate=image',
    wrappedByKey: 'data',
});

const STRAPI_API_URL = import.meta.env.STRAPI_URL;
---

<section id="blogs" class="text-gray-300 body-font">
    <div class="container px-32 pb-32 mx-auto">
        <div class="flex items-center text-purple-600 gap-4 mb-8">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-10 h-10"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"
                ></path>
            </svg>
            <h1 class="text-4xl md:text-5xl text-white font-mono ml-2">blogs</h1>
        </div>
        <div class="font-mono">
            <ul class="grid grid-cols-1 gap-6">
                {
                    articles.slice(0, 3).map((article) => (
                        <li class="border border-purple-600 rounded-md p-4">
                            <a
                                href={`/blog/${article.slug}/`}
                                class="group flex flex-col sm:flex-row items-start sm:items-center gap-4 transition-all duration-300 ease-in-out hover:text-purple-400"
                            >
                                {article.image && (
                                    <img
                                        src={`${STRAPI_API_URL}${article.image.formats.small.url}`}
                                        alt={article.title}
                                        class="w-24 object-contain rounded-md flex-shrink-0"
                                    />
                                )}
                                <div class="flex-1 min-w-0">
                                    <div class="text-xs text-gray-500 mb-1">
                                        {new Date(article.publish_date).toLocaleDateString('vi-VN')}
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <h3 class="text-xl text-white font-bold transition-all duration-300 ease-in-out group-hover:text-purple-400">
                                            {article.title}
                                        </h3>
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            fill="none"
                                            viewBox="0 0 24 24"
                                            stroke-width="1.5"
                                            stroke="currentColor"
                                            class="w-5 h-5 text-gray-500 transition-all duration-300 ease-in-out group-hover:translate-x-1 group-hover:-translate-y-1 group-hover:text-purple-400 flex-shrink-0"
                                        >
                                            <path
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                d="m4.5 19.5 15-15m0 0H8.25m11.25 0v11.25"
                                            />
                                        </svg>
                                    </div>
                                </div>
                            </a>
                        </li>
                    ))
                }
            </ul>
        </div>
    </div>
</section>
