<div class="fixed inset-0 pointer-events-none -z-[10]">
    <div class="firefly"></div>
    <div class="firefly"></div>
    <div class="firefly"></div>
    <div class="firefly"></div>
    <div class="firefly"></div>
    <div class="firefly"></div>
    <div class="firefly"></div>
    <div class="firefly"></div>
</div>

<style>
    .firefly {
        position: absolute;
        width: 6px;
        height: 6px;
        background: #d500d5;
        border-radius: 50%;
        box-shadow:
            0 0 15px 5px rgba(213, 0, 213, 0.7),
            0 0 30px 10px rgba(213, 0, 213, 0.3);
        animation: flutter linear infinite;
    }

    @keyframes flutter {
        0%,
        100% {
            transform: translate(0, 0);
            opacity: 0.9;
        }
        16% {
            transform: translate(calc(-50px + 100px * var(--random-x1)), calc(-50px + 100px * var(--random-y1)));
            opacity: 0.8;
        }
        32% {
            transform: translate(calc(-50px + 100px * var(--random-x2)), calc(-50px + 100px * var(--random-y2)));
            opacity: 0.7;
        }
        48% {
            transform: translate(calc(-50px + 100px * var(--random-x3)), calc(-50px + 100px * var(--random-y3)));
            opacity: 0.6;
        }
        64% {
            transform: translate(calc(-50px + 100px * var(--random-x4)), calc(-50px + 100px * var(--random-y4)));
            opacity: 0.7;
        }
        80% {
            transform: translate(calc(-50px + 100px * var(--random-x5)), calc(-50px + 100px * var(--random-y5)));
            opacity: 0.8;
        }
    }
</style>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        const fireflies = document.querySelectorAll('.firefly');
        const gridRows = 2;
        const gridCols = 5;
        const maxMove = 200;
        const minDuration = 3;
        const maxDuration = 8;

        fireflies.forEach((el, index) => {
            const firefly = el as HTMLElement;

            const col = index % gridCols;
            const row = Math.floor(index / gridCols);

            const cellWidth = window.innerWidth / gridCols;
            const cellHeight = window.innerHeight / gridRows;

            let x = col * cellWidth + Math.random() * cellWidth;
            let y = row * cellHeight + Math.random() * cellHeight;

            firefly.style.left = `${x}px`;
            firefly.style.top = `${y}px`;

            let duration = minDuration + Math.random() * (maxDuration - minDuration);
            let delay = Math.random() * 5;
            firefly.style.animationDuration = `${duration}s`;
            firefly.style.animationDelay = `${delay}s`;

            const moveFirefly = () => {
                x += (Math.random() - 0.5) * maxMove;
                y += (Math.random() - 0.5) * maxMove;

                // Giới hạn firefly không ra ngoài màn hình
                x = Math.max(0, Math.min(window.innerWidth - 6, x));
                y = Math.max(0, Math.min(window.innerHeight - 6, y));

                firefly.animate(
                    [
                        { transform: `translate(0,0)`, opacity: 0.9 },
                        {
                            transform: `translate(${x - parseFloat(firefly.style.left)}px, ${y - parseFloat(firefly.style.top)}px)`,
                            opacity: 0.6,
                        },
                        { transform: `translate(0,0)`, opacity: 0.9 },
                    ],
                    {
                        duration: duration * 1000,
                        iterations: 1,
                        easing: 'linear',
                    },
                ).onfinish = moveFirefly;
            };

            requestAnimationFrame(moveFirefly);
        });
    });
</script>
