---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Loader from '../components/Loader.astro';
import '../styles/tailwind.css';
import { getTranslations, getLangFromUrl } from '../locales';
const currentLang = getLangFromUrl(Astro.url);
const translations = await getTranslations(currentLang);

const { title } = Astro.props;
const langMap: Record<'en' | 'vi', string> = {
    en: 'en_US',
    vi: 'vi_VN',
};
const lang = langMap[(currentLang as 'en' | 'vi') || 'en'];

const websiteJsonLd = JSON.stringify({
  "@context": "https://schema.org",
  "@type": "WebSite",
  "url": "https://jokholk.dev",
  "name": "JokHolk Portfolio",
  "inLanguage": currentLang,
  "author": {
    "@type": "Person",
    "@id": "https://jokholk.dev/#person"
  }
});
---

<html lang={currentLang}>
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/x-icon" href="/favicon.ico" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
            rel="stylesheet"
        />
        <link rel="sitemap" href="/sitemap-index.xml" />
        <meta name="description" content={translations.description} />
        <meta
            name="keywords"
            content="JokHolk, software development, game projects, cybersecurity, portfolio, programming, developer, indie game, personal website, Jok Holk, Thai Nguyen, Nguyen Bui Phuc Thai, Thái Nguyễn, Nguyễn Bùi Phúc Thái"
        />
        <meta name="author" content="JokHolk" />
        <meta name="robots" content="index, follow" />
        <link rel="canonical" href={Astro.url} />
        <meta property="og:title" content={translations.title} />
        <meta property="og:description" content={translations.description} />
        <meta property="og:image" content="https://jokholk.dev/avatar.webp" />
        <meta property="og:url" content={Astro.url} />
        <meta property="og:locale" content={lang} />

        <meta property="og:type" content="website" />
        <meta name="color-scheme" content="dark">
        <meta name="theme-color" content="#000000" />

        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "Person",
                "@id": "https://jokholk.dev/#person",
                "name": "JokHolk",
                "alternateName": [
                    "Jok Holk",
                    "jokholk",
                    "Jok-Holk",
                    "jok-holk",
                    "Jok_Holk",
                    "jok_holk",
                    "Thai Nguyen",
                    "Thái Nguyễn",
                    "Nguyen Bui Phuc Thai",
                    "Nguyễn Bùi Phúc Thái"
                ],
                "url": "https://jokholk.dev",
                "image": "https://jokholk.dev/avatar.webp",
                "description": "Personal portfolio showcasing my journey in cybersecurity, web development, and game development.",
                "jobTitle": "Cybersecurity Student",
                "knowsAbout": ["Cybersecurity", "Web Development", "Game Development"],
                "memberOf": [
                    {
                        "@type": "CollegeOrUniversity",
                        "name": "FPT Polytechnic",
                        "alternateName": "FPT Polytechnic College",
                        "description": "A vocational college under FPT Education, focused on hands-on training."
                    },
                    {
                        "@type": "CollegeOrUniversity",
                        "name": "FUNiX",
                        "alternateName": "FUNiX Online University",
                        "description": "An online education institution under FPT Education, specializing in IT distance learning."
                    }
                ],
                "sameAs": [
                    "https://github.com/Jok-Holk",
                    "https://facebook.com/jokholk.real",
                    "https://tryhackme.com/p/JokHolk"
                ]
            }
        </script>
        <script type="application/ld+json" is:inline>
           {websiteJsonLd}
        </script>
    </head>
    <body class="bg-black text-gray-300 pt-0">
        <div id="loader" class="loader">
            <Loader />
        </div>
        <Header translations={translations} currentLang={currentLang} />
        <main>
            <slot />
        </main>
        <Footer translations={translations} currentLang={currentLang} />
        <script src="https://cdn.jsdelivr.net/npm/motion@latest/dist/motion.umd.js" is:inline></script>
        <script src="/scripts/scroll-animate.js" is:inline></script>
    </body>
</html>
<style>
    .loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background: black;
        z-index: 9999;
    }
</style>
<script>
    window.onload = () => {
        const loader = document.getElementById('loader');
        if (loader) {
            loader.style.display = 'none';
        }
    };
</script>
